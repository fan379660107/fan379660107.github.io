(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-69918464"],{"0c5d":function(e,t,r){"use strict";r("6927")},"14e4":function(e,t,r){"use strict";r("912e")},"3be9":function(e,t,r){},"634e":function(e,t,r){"use strict";r("f91c")},6927:function(e,t,r){},"8bd7":function(e,t,r){"use strict";r.d(t,"e",(function(){return n})),r.d(t,"b",(function(){return i})),r.d(t,"d",(function(){return s})),r.d(t,"c",(function(){return o})),r.d(t,"f",(function(){return c})),r.d(t,"a",(function(){return l}));var a=r("b775");function n(e){return Object(a["a"])({url:"/api/vm-service/region/search",params:e})}function i(e){return Object(a["a"])({url:"/api/vm-service/region",method:"POST",data:e})}function s(e){return Object(a["a"])({url:"/api/vm-service/region/"+e})}function o(e){return Object(a["a"])({url:"/api/vm-service/region/"+e.id,method:"PUT",data:e})}function c(e){return Object(a["a"])({url:"/api/vm-service/node/search",params:e})}function l(e){return Object(a["a"])({url:"/api/vm-service/region/"+e,method:"DELETE"})}},"912e":function(e,t,r){},"9ab0":function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"search"},[r("el-form",{ref:"formInline",staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline}},[r("el-form-item",{attrs:{label:e.firstItem}},[r("el-input",{attrs:{placeholder:"请输入"},model:{value:e.formInline.user,callback:function(t){e.$set(e.formInline,"user",t)},expression:"formInline.user"}}),e.formInline.user?r("i",{staticClass:"el-icon-circle-close",on:{click:function(t){e.formInline.user=""}}}):e._e()],1),e.isSelect?r("el-form-item",{attrs:{label:e.secondItem}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.formInline.region,callback:function(t){e.$set(e.formInline,"region",t)},expression:"formInline.region"}},e._l(e.selectOption,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1),e.formInline.region?r("i",{staticClass:"el-icon-circle-close",on:{click:function(t){e.formInline.region=""}}}):e._e()],1):e._e(),r("el-form-item",[r("bb-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.search(t)}}},[r("i",{staticClass:"el-icon-search"}),e._v(" 查询 ")])],1)],1)],1)])},n=[],i={name:"searchTop",data:function(){return{firstItem:this.searchItem.firstItem,secondItem:this.searchItem.secondItem||"",isSelect:this.searchItem.isSelect,selectOption:[],formInline:this.searchItem.formInline}},computed:{},props:{searchItem:{type:Object,required:!0}},methods:{search:function(){this.$emit("searchForm",this.formInline),this.$refs.formInline.resetFields()},onSubmit:function(){console.log("submit!")},handleSelectChange:function(){}}},s=i,o=(r("e36b"),r("2877")),c=Object(o["a"])(s,a,n,!1,null,"39f00194",null);t["a"]=c.exports},c6b5:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("SearchTop",{ref:"SearchTop",attrs:{searchItem:e.searchItem},on:{searchForm:e.searchFormFn}}),r("bkdTable",e._b({attrs:{NavList:e.NavList,isShow:e.isShow,baseParams:e.baseParams},on:{add:e.addFn,changePage:e.changePageFn}},"bkdTable",e.AreaList,!1,!0),[r("el-table-column",{attrs:{label:"操作","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){return e.handleClick(t.row)}}},[e._v("查看详情")]),r("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(r){return e.addFn(t.row)}}},[e._v("修改")]),r("el-button",{staticStyle:{color:"red"},attrs:{type:"text",size:"small"},nativeOn:{click:function(r){return e.deleteRow(t.row)}}},[e._v("删除")])]}}])})],1),r("addDialog",{ref:"addDialog",attrs:{visible:e.dialogFormVisible,AreaList:e.AreaList,editAreaList:e.editAreaList},on:{"update:visible":function(t){e.dialogFormVisible=t},add:e.addPoint,edit:e.editFn}}),r("ShowDetail",{ref:"showDetail",attrs:{Visible:e.Visible},on:{"update:Visible":function(t){e.Visible=t},"update:visible":function(t){e.Visible=t}}})],1)},n=[],i=r("c7eb"),s=r("1da1"),o=(r("d3b7"),r("159b"),r("fb6a"),r("b0c0"),r("9ab0")),c=r("c929"),l=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{title:"区域详情",visible:e.Visible,width:"41%"},on:{close:e.onClose}},[r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[r("el-table-column",{attrs:{type:"index",label:"序号"}}),r("el-table-column",{attrs:{prop:"innerCode",label:"机器编号"}}),r("el-table-column",{attrs:{prop:"vmStatus",label:"设备状态"}}),r("el-table-column",{attrs:{prop:"lastSupplyTime",label:"最后一次供货时间"}})],1)],1)},u=[],d=r("c932"),m={name:"ShowDetail",data:function(){return{tableData:[],areaName:""}},props:{Visible:{type:Boolean,required:!0}},created:function(){},methods:{onClose:function(){this.$emit("update:Visible",!1)},showDetailContent:function(e){var t=this;return Object(s["a"])(Object(i["a"])().mark((function r(){var a,n;return Object(i["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return console.log(e),r.next=3,Object(d["e"])(e.id);case 3:a=r.sent,n=a.data,console.log(n),t.tableData=n,t.tableData.forEach((function(e){0===e.vmStatus?e.vmStatus="未投放":1===e.vmStatus?e.vmStatus="运营":e.vmStatus="撤机"}));case 8:case"end":return r.stop()}}),r)})))()}}},f=m,p=(r("634e"),r("2877")),b=Object(p["a"])(f,l,u,!1,null,"74d0a2ca",null),h=b.exports,g=r("8bd7"),v=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{title:e.titleDialog,visible:e.visible,width:"41%"},on:{close:e.onClose}},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.form,rules:e.rules}},[r("el-form-item",{attrs:{label:"点位名称:","label-width":e.formLabelWidth,prop:"name"}},[r("el-input",{attrs:{autocomplete:"off",placeholder:"请输入",maxlength:"15","show-word-limit":""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name","string"===typeof t?t.trim():t)},expression:"form.name"}})],1),r("el-form-item",{attrs:{label:"所在区域:","label-width":e.formLabelWidth,prop:"regionName"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.regionName,callback:function(t){e.$set(e.form,"regionName",t)},expression:"form.regionName"}},e._l(e.selectOption,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),r("el-form-item",{attrs:{label:"所属商圈:","label-width":e.formLabelWidth,prop:"businessTypeName"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.businessTypeName,callback:function(t){e.$set(e.form,"businessTypeName",t)},expression:"form.businessTypeName"}},e._l(e.businessTypeNameList,(function(e,t){return r("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1),r("el-form-item",{attrs:{label:"归属合作商:","label-width":e.formLabelWidth,prop:"ownerName"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.ownerName,callback:function(t){e.$set(e.form,"ownerName",t)},expression:"form.ownerName"}},e._l(e.ownerNameList,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e}})})),1)],1),r("el-form-item",{attrs:{label:"详细地址:","label-width":e.formLabelWidth,prop:"selectedOptions"}},[r("div",{attrs:{id:"app"}},[r("el-cascader",{attrs:{size:"large",options:e.options},on:{change:e.handleChange},model:{value:e.selectedOptions,callback:function(t){e.selectedOptions=t},expression:"selectedOptions"}})],1)]),r("el-form-item",{attrs:{"label-width":e.formLabelWidth,prop:"addrDetail"}},[r("el-input",{attrs:{type:"textarea",autocomplete:"off",placeholder:"请输入详细地址",maxlength:"40","show-word-limit":""},model:{value:e.form.addrDetail,callback:function(t){e.$set(e.form,"addrDetail",t)},expression:"form.addrDetail"}})],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.onClose}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确 定")])],1)],1)},w=[],O=(r("25f0"),r("ac1f"),r("1276"),r("ef6c")),N={name:"addDialog",data:function(){return{form:{name:"",regionName:"",businessTypeName:"",ownerName:"",addr:"",addrDetail:"",id:""},formLabelWidth:"140px",rules:{name:[{required:!0,message:"请输入区域名称",trigger:"blur"}],regionName:[{required:!0,message:"请输入所在区域",trigger:"blur"}],businessTypeName:[{required:!0,message:"请输入所属商圈",trigger:"blur"}],ownerName:[{required:!0,message:"请输入归属合作商",trigger:"blur"}],addr:[{required:!0,message:"请输入详细地址",trigger:"blur"}],addrDetail:[{required:!0,message:"请输入详细地址",trigger:"blur"}]},selectOption:[],regionNameList:[],businessTypeNameList:[],ownerNameList:[],addrList:[],options:O["regionData"],selectedOptions:[],nameList:[]}},props:{visible:{type:Boolean,default:!1},AreaList:{type:Object}},created:function(){},computed:{titleDialog:function(){return this.form.id?"修改区域":"新增区域"}},methods:{onClose:function(){var e=this;return Object(s["a"])(Object(i["a"])().mark((function t(){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$emit("update:visible",!1),e.$refs.ruleForm.resetFields(),e.form={name:"",regionName:"",businessTypeName:"",ownerName:"",addr:"",addrDetail:"",id:""};case 3:case"end":return t.stop()}}),t)})))()},confirm:function(){var e=this;return Object(s["a"])(Object(i["a"])().mark((function t(){var r;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.ruleForm.validate();case 2:if(!e.form.id){t.next=11;break}return"NaN"==parseFloat(e.form.regionName).toString()&&(e.form.regionName=e.form.regionId),"NaN"==parseFloat(e.form.businessTypeName).toString()&&(e.form.businessTypeName=e.form.businessType.id),"NaN"==parseFloat(e.form.ownerName).toString()&&(e.form.ownerName={id:e.form.ownerId,name:e.form.ownerName}),isNaN(e.selectedOptions)||(r=e.form.addr.split("-"),e.form.addr=[r[0]+"-"+r[1]+"-"+r[2],e.form.areaCode]),t.next=9,e.$emit("edit",e.form);case 9:t.next=13;break;case 11:return t.next=13,e.$emit("add",e.form);case 13:e.onClose();case 14:case"end":return t.stop()}}),t)})))()},getNodeList:function(){var e=this;return Object(s["a"])(Object(i["a"])().mark((function t(){var r,a,n,s;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(d["f"])({pageSize:e.AreaList.totalCount});case 2:return r=t.sent,a=r.data,t.next=6,Object(d["d"])();case 6:return n=t.sent,e.businessTypeNameList=n.data,e.regionNameList=e.selectOption,t.next=11,Object(d["g"])({pageSize:1e4});case 11:s=t.sent,e.ownerNameList=s.data.currentPageRecords,a.currentPageRecords.forEach((function(t){e.nameList.push(t.name)}));case 14:case"end":return t.stop()}}),t)})))()},handleChange:function(e){for(var t="",r=0;r<e.length;r++)t+=O["CodeToText"][e[r]]+"-";this.form.addr=[t.substr(0,t.length-1),e[e.length-1]]},showEditContent:function(e){var t=this;return Object(s["a"])(Object(i["a"])().mark((function r(){var a,n,s,o;return Object(i["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,Object(d["f"])(e);case 2:a=r.sent,n=a.data,t.form=n.currentPageRecords[0],t.form.id=n.currentPageRecords[0].id?n.currentPageRecords[0].id:"",t.form.name=n.currentPageRecords[0].name?n.currentPageRecords[0].name:"",t.form.regionName=n.currentPageRecords[0].region.name?n.currentPageRecords[0].region.name:"",t.form.businessTypeName=n.currentPageRecords[0].businessType.name?n.currentPageRecords[0].businessType.name:"",t.form.ownerName=n.currentPageRecords[0].ownerName?n.currentPageRecords[0].ownerName:"",n.currentPageRecords[0].addr?(s=-1===n.currentPageRecords[0].addr.indexOf("/")?n.currentPageRecords[0].addr.split("-"):n.currentPageRecords[0].addr.split("/"),console.log(s),t.selectedOptions=O["TextToCode"][s[0]][s[1]][s[2]].code?O["TextToCode"][s[0]][s[1]][s[2]].code:"",t.form.addrDetail=s[s.length-1]):(o="",t.selectedOptions=o,t.form.addrDetail=o[o.length-1]);case 11:case"end":return r.stop()}}),r)})))()}}},x=N,j=(r("14e4"),Object(p["a"])(x,v,w,!1,null,"cda1f7f4",null)),y=j.exports,I={data:function(){return{searchItem:{firstItem:"点位搜索",secondItem:"区域搜索",isSelect:!0,selectOption:[],formInline:{user:"",region:""}},NavList:[{label:"点位名称",value:"name"},{label:"所在区域",value:"region.name"},{label:"商圈类型",value:"businessType.name"},{label:"合作商",value:"ownerName"},{label:"详细地址",value:"addrName"}],baseParams:{pageIndex:1,pageSize:10},AreaList:{},isShow:!1,dialogFormVisible:!1,editAreaList:{},Visible:!1}},components:{SearchTop:o["a"],bkdTable:c["a"],addDialog:y,ShowDetail:h},created:function(){this.getNodeSearch()},beforeUpdate:function(){this.AreaList.pageSize=+this.AreaList.pageSize,this.AreaList.pageIndex=+this.AreaList.pageIndex},methods:{getNodeSearch:function(e){var t=this;return Object(s["a"])(Object(i["a"])().mark((function r(){var a,n,s;return Object(i["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,Object(g["e"])({pageSize:1e5});case 2:return a=r.sent,t.$refs.SearchTop.selectOption=a.data.currentPageRecords,t.$refs.addDialog.selectOption=a.data.currentPageRecords,r.next=7,Object(d["f"])(e);case 7:n=r.sent,s=n.data,t.AreaList=s,t.AreaList.currentPageRecords.forEach((function(e){e.addrName=e.addr.slice(12)?e.addr.slice(12):e.addr.slice(8,10)}));case 11:case"end":return r.stop()}}),r)})))()},searchFormFn:function(e){this.getNodeSearch({name:e.user?e.user:"",regionId:e.region?e.region:""})},addFn:function(e){var t=this;return Object(s["a"])(Object(i["a"])().mark((function r(){return Object(i["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!e){r.next=4;break}return t.editAreaList=e,r.next=4,t.$refs.addDialog.showEditContent({name:e.name,regionId:e.regionId});case 4:t.$refs.addDialog.getNodeList(),t.dialogFormVisible=!0;case 6:case"end":return r.stop()}}),r)})))()},addPoint:function(e){var t=this;return Object(s["a"])(Object(i["a"])().mark((function r(){return Object(i["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,Object(d["a"])({name:e.name,addr:e.addr[0]+"-"+e.addrDetail,areaCode:e.addr[1],createUserId:t.$store.state.user.userId,regionId:e.regionName,businessId:e.businessTypeName,ownerId:e.ownerName.id,ownerName:e.ownerName.name});case 3:t.$message.success("添加成功"),r.next=10;break;case 6:r.prev=6,r.t0=r["catch"](0),t.$message.error("添加失败"),t.$message.error(r.t0.response.data);case 10:case"end":return r.stop()}}),r,null,[[0,6]])})))()},editFn:function(e){var t=this;return Object(s["a"])(Object(i["a"])().mark((function r(){return Object(i["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return console.log(e),r.prev=1,r.next=4,Object(d["c"])({id:e.id,name:e.name,addr:e.addr[0]+"-"+e.addrDetail,areaCode:e.addr[1],createUserId:t.$store.state.user.userId,regionId:e.regionName,businessId:e.businessTypeName,ownerId:e.ownerName.id,ownerName:e.ownerName.name});case 4:t.$message.success("编辑成功"),r.next=11;break;case 7:r.prev=7,r.t0=r["catch"](1),t.$message.error("编辑失败"),t.$message.error(r.t0.response.data);case 11:case"end":return r.stop()}}),r,null,[[1,7]])})))()},handleClick:function(e){var t=this;return Object(s["a"])(Object(i["a"])().mark((function r(){return Object(i["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$refs.showDetail.showDetailContent(e);case 2:t.Visible=!0;case 3:case"end":return r.stop()}}),r)})))()},deleteRow:function(e){var t=this;return Object(s["a"])(Object(i["a"])().mark((function r(){return Object(i["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,Object(d["b"])(e.id);case 3:t.getNodeSearch(),r.next=9;break;case 6:r.prev=6,r.t0=r["catch"](0),t.$message.error(r.t0.response.data);case 9:case"end":return r.stop()}}),r,null,[[0,6]])})))()},changePageFn:function(){this.getNodeSearch({pageIndex:this.AreaList.pageIndex,pageSize:this.AreaList.pageSize})}}},S=I,k=Object(p["a"])(S,a,n,!1,null,"de616af8",null);t["default"]=k.exports},c929:function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"table"},[r("el-card",{staticClass:"box-card",attrs:{shadow:"never"}},[r("el-row",{staticClass:"btn-col",attrs:{type:"flex"}},[r("el-col",{staticClass:"btn1",attrs:{span:2}},[e.isShowNew?r("dkd-button",{attrs:{user:"create"},on:{click:function(t){return e.$emit("add")}}},[e._v("新建")]):e._e()],1),r("el-col",[e.isShow?r("dkd-button",{attrs:{user:"cancel"}},[e._v("工单配置")]):e._e()],1)],1),r("div",{staticClass:"table-container"},[r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.currentPageRecords}},[r("el-table-column",{attrs:{label:"序号",type:"index",index:e.num,width:"80"}}),e._l(e.NavList,(function(e,t){return r("el-table-column",{key:t,attrs:{prop:e.value,label:e.label,"min-width":"创建日期"===e.label?200:120}})})),e._t("default")],2)],1),r("el-pagination",{staticClass:"el-pagination-container",attrs:{"hide-on-single-page":!0,"current-page":e.pageIndex,"page-size":+e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:+e.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},n=[],i=(r("a9e3"),r("d3b7"),r("159b"),r("ac1f"),r("5319"),{name:"Table",data:function(){return{}},props:{NavList:{type:Array,required:!0},isShowNew:{type:Boolean,default:!0},isShow:{type:Boolean,default:!0},currentPageRecords:{type:Array,default:function(){return[]}},pageIndex:{type:Number,default:1},pageSize:{type:Number,default:10},totalCount:{type:String,default:"0"},totalPage:{type:String,default:"0"}},updated:function(){},watch:{currentPageRecords:{immediate:!0,handler:function(){this.currentPageRecords.forEach((function(e){var t;e.createType=0===e.createType?"自动":"手动",e.updateTime=null===(t=e.updateTime)||void 0===t?void 0:t.replace("T"," ")}))}}},computed:{num:function(){return(this.pageIndex-1)*this.pageSize+1}},methods:{handleSizeChange:function(e){this.$emit("update:pageSize",e),this.$emit("changePage")},handleCurrentChange:function(e){this.$emit("update:pageIndex",e),this.$emit("changePage")},handleClick:function(e){console.log(e)}}}),s=i,o=(r("0c5d"),r("2877")),c=Object(o["a"])(s,a,n,!1,null,"e7e1a1e0",null);t["a"]=c.exports},c932:function(e,t,r){"use strict";r.d(t,"f",(function(){return n})),r.d(t,"a",(function(){return i})),r.d(t,"d",(function(){return s})),r.d(t,"g",(function(){return o})),r.d(t,"e",(function(){return c})),r.d(t,"c",(function(){return l})),r.d(t,"b",(function(){return u}));var a=r("b775");function n(e){return Object(a["a"])({url:"/api/vm-service/node/search",params:e})}function i(e){return Object(a["a"])({url:"/api/vm-service/node",method:"POST",data:e})}function s(){return Object(a["a"])({url:"/api/vm-service/businessType"})}function o(e){return Object(a["a"])({url:"/api/user-service/partner/search",params:e})}function c(e){return Object(a["a"])({url:"/api/vm-service/node/vmList/"+e})}function l(e){return Object(a["a"])({url:"/api/vm-service/node/"+e.id,method:"PUT",data:e})}function u(e){return Object(a["a"])({url:"/api/vm-service/node/"+e,method:"DELETE"})}},e36b:function(e,t,r){"use strict";r("3be9")},f91c:function(e,t,r){}}]);