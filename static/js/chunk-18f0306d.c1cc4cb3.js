(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-18f0306d"],{"23d1":function(e,t,a){"use strict";a("ccc0")},"35ea":function(e,t,a){},3650:function(e,t,a){"use strict";a("8e99")},6997:function(e,t,a){},"8e99":function(e,t,a){},"95c3":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("searchTop",{attrs:{searchItem:e.searchItem},on:{searchForm:e.searchGoods}}),a("el-card",{staticClass:"box-card"},[a("el-button",{staticClass:"elBtn",attrs:{icon:"el-icon-circle-plus-outline"},on:{click:e.newGoods}},[e._v(" 新建 ")]),a("el-button",{staticClass:"importBtn",on:{click:function(t){e.dialogVisibleTwo=!0}}},[e._v(" 工单配置 ")]),a("el-dialog",{staticClass:"dialog-title",attrs:{title:"工单配置",visible:e.dialogVisibleTwo,width:"30%"},on:{"update:visible":function(t){e.dialogVisibleTwo=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.formRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"补货警戒线:",prop:"num"}},[a("el-input-number",{attrs:{"controls-position":"right",min:1,max:10},on:{change:e.handleChange},model:{value:e.form.num,callback:function(t){e.$set(e.form,"num",t)},expression:"form.num"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisibleTwo=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.onSave}},[e._v("确 定")])],1)],1),a("workTable",{ref:"workPaging",on:{paging:e.pagingFn,editWork:e.editWork}}),a("div",{staticClass:"paging"},[a("div",[e._v(" 共"),a("span",[e._v(e._s(e.paging.totalCount))]),e._v("条记录 第"),a("span",[e._v(e._s(e.paging.pageIndex))]),e._v("/"),a("span",[e._v(e._s(e.paging.totalPage))]),e._v("页 ")]),a("div",{staticClass:"pagingBtn"},[a("el-button",{attrs:{disabled:e.paging.pageIndex<=1},on:{click:e.PreviousPage}},[e._v("上一页")]),a("el-button",{attrs:{disabled:e.paging.pageIndex===e.paging.totalPage},on:{click:e.nextPage}},[e._v("下一页")])],1)])],1),a("addWorkList",{ref:"addWork",attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}}),a("el-dialog",{attrs:{title:"工单详情",visible:e.dialogVisibleTree,width:"30%"},on:{"update:visible":function(t){e.dialogVisibleTree=t}}},[a("el-row",[a("el-col",{attrs:{span:12}})],1),a("el-row",{staticStyle:{"margin-bottom":"10px"}},[a("el-col",{attrs:{span:12}},[e._v("设备编号:"+e._s(e.list.innerCode))]),a("el-col",{attrs:{span:12}},[e._v("创建日期:"+e._s(e.list.createTime))])],1),a("el-row",{staticStyle:{"margin-bottom":"10px"}},[a("el-col",{attrs:{span:12}},[e._v("运营人员:"+e._s(e.list.userName))])],1),a("el-row",{staticStyle:{"margin-bottom":"10px"}},[a("el-col",{attrs:{span:12}},[e._v("补货数量: "),a("span",{staticStyle:{color:"#5f84ff",cursor:"pointer"},on:{click:e.clickFn}},[e._v("补货详情")])]),a("el-col",{attrs:{span:12}},[e._v("工单方式:"+e._s(e.list.createType))])],1),a("el-row",[a("el-col",{attrs:{span:12}},[e._v("备注:"+e._s(e.list.desc))]),a("el-col",{attrs:{span:12}})],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.delWork}},[e._v("取消工单")])],1)],1),a("el-dialog",{attrs:{title:"补货详情",visible:e.dialogVisiblefoure,width:"30%"},on:{close:e.onClose}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.ReplenishmentDetails}},[a("el-table-column",{attrs:{prop:"channelCode",label:"货道编号",width:"180"}}),a("el-table-column",{attrs:{prop:"skuName",label:"商品",width:"180"}}),a("el-table-column",{attrs:{prop:"expectCapacity",label:"补满数量",width:"170"}})],1)],1)],1)},s=[],i=a("c7eb"),n=a("1da1"),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"search"},[a("el-form",{ref:"formInline",staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline}},[a("el-form-item",{attrs:{label:e.firstItem}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.formInline.user,callback:function(t){e.$set(e.formInline,"user",t)},expression:"formInline.user"}}),e.formInline.user?a("i",{staticClass:"el-icon-circle-close",on:{click:function(t){e.formInline.user=""}}}):e._e()],1),e.isSelect?a("el-form-item",{attrs:{label:e.secondItem}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.formInline.region,callback:function(t){e.$set(e.formInline,"region",t)},expression:"formInline.region"}},[a("div",e._l(e.selectOption,(function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1)]),e.formInline.user?a("i",{staticClass:"el-icon-circle-close",on:{click:function(t){e.formInline.user=""}}}):e._e()],1):e._e(),a("el-form-item",[a("bb-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.search(t)}}},[a("i",{staticClass:"el-icon-search"}),e._v(" 查询 ")])],1)],1)],1)])},l=[],c=(a("d3b7"),{data:function(){return{firstItem:this.searchItem.firstItem,secondItem:this.searchItem.secondItem||"",isSelect:this.searchItem.isSelect,selectOption:this.searchItem.selectOption,formInline:this.searchItem.formInline}},computed:{isShow:function(){var e=this;this.selectOption.some((function(t){return e.formInline.region===t.value}))}},props:{searchItem:{type:Object,required:!0}},created:function(){},methods:{search:function(){this.$emit("searchForm",this.formInline),this.$refs.formInline.resetFields()},onSubmit:function(){console.log("submit!")}}}),u=c,d=(a("d527"),a("2877")),p=Object(d["a"])(u,o,l,!1,null,"9575da78",null),m=p.exports,f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-table",{staticStyle:{width:"98%",margin:"auto"},attrs:{data:e.tableData,stripe:""}},[a("el-table-column",{attrs:{type:"index",label:e.workListTitle.index,width:"100"}}),a("el-table-column",{attrs:{prop:"taskCode",label:e.workListTitle.taskCode,width:"180"}}),a("el-table-column",{attrs:{prop:"innerCode",label:e.workListTitle.innerCode,width:"180"}}),a("el-table-column",{attrs:{prop:"taskType.typeName",label:e.workListTitle.taskType.typeName,width:"180"}}),a("el-table-column",{attrs:{prop:"createType",label:e.workListTitle.createType,width:"180"}}),a("el-table-column",{attrs:{prop:"taskStatus",label:e.workListTitle.taskStatus,width:"180"}}),a("el-table-column",{attrs:{prop:"userName",label:e.workListTitle.userName,width:"180"}}),a("el-table-column",{attrs:{prop:"updateTime",label:e.workListTitle.updateTime,width:"180"}}),a("el-table-column",{attrs:{prop:"address",label:e.workListTitle.operation,width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){return e.$emit("editWork",t.row)}}},[e._v("查看详情")])]}}])})],1)},b=[],h=(a("159b"),a("ac1f"),a("5319"),a("b775")),g=function(e){return Object(h["a"])({url:"/api/task-service/task/search",params:e})},k=function(e){return Object(h["a"])({url:"/api/task-service/task/create",method:"POST",data:e})},v=function(e){return Object(h["a"])({url:"/api/task-service/taskType/list",params:e})},w=function(e){return Object(h["a"])({url:"/api/task-service/taskDetails/"+e})},x=function(e){return Object(h["a"])({url:"/api/user-service/user/operatorList/".concat(e),method:"GET"})},I=function(){return Object(h["a"])({url:"/api/task-service/task/supplyAlertValue"})},y=function(e){return Object(h["a"])({url:"/api/task-service/task/cancel/"+e.taskId,method:"POST",data:e})},T={name:"GoodsTable",data:function(){return{workListTitle:{index:"序号",taskCode:"工单编号",innerCode:"设备编号",taskType:{typeName:"工单类型"},createType:"工单方式",taskStatus:"工单状态",userName:"运营人员",updateTime:"创建时间",operation:"操作"},tableData:[],pageIndex:1}},updated:function(){this.tableData.forEach((function(e){return e.createType=e.createType?"手动":"自动"})),this.tableData.forEach((function(e){return e.updateTime=e.updateTime.replace("T"," ")})),this.tableData.forEach((function(e){return 1===e.taskStatus?e.taskStatus="投放工单":2===e.taskStatus?e.taskStatus="补货工单":3===e.taskStatus?e.taskStatus="维修工单":4===e.taskStatus?e.taskStatus="撤机工单":e.taskStatus="xx工单"}))},methods:{getWorkOrderList:function(e,t){var a=this;return Object(n["a"])(Object(i["a"])().mark((function r(){var s;return Object(i["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,g({pageIndex:a.pageIndex,taskCode:e,status:t});case 2:s=r.sent,a.$emit("paging",s.data),a.tableData=s.data.currentPageRecords;case 5:case"end":return r.stop()}}),r)})))()},pageIndexjiajia:function(){console.log(111),this.pageIndex++},pageIndexjianjian:function(){this.pageIndex--}},created:function(){this.getWorkOrderList()}},O=T,C=(a("3650"),Object(d["a"])(O,f,b,!1,null,"16f96c87",null)),j=C.exports,_=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"新增工单",visible:e.visible,width:"30%"},on:{close:e.onClose}},[a("el-form",{ref:"form",attrs:{rules:e.workRoules,model:e.formData,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"设备编号:",prop:"innerCode"}},[a("el-input",{attrs:{type:"text",placeholder:"请输入",maxlength:"15","show-word-limit":""},on:{input:e.replenishments},model:{value:e.formData.innerCode,callback:function(t){e.$set(e.formData,"innerCode",t)},expression:"formData.innerCode"}})],1),a("el-form-item",{attrs:{label:"工单类型:",prop:"productType"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.formData.productType,callback:function(t){e.$set(e.formData,"productType",t)},expression:"formData.productType"}},e._l(e.productTypeList,(function(e){return a("el-option",{key:e.typeId,attrs:{label:e.typeName,value:e.typeId}})})),1)],1),a("el-form-item",{attrs:{label:"补货数量:",prop:"details"}},[a("div",{staticClass:"box",on:{click:e.replenishment}},[a("i",{staticClass:"el-icon-s-order"}),a("span",[e._v("补货清单")])]),a("el-dialog",{attrs:{title:"补货详情",visible:e.dialogVisible,width:"30%",modal:!1},on:{close:e.onCloseList}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,height:"310px"}},[a("el-table-column",{attrs:{prop:"channelCode",label:"货道编号",width:"80"}}),a("el-table-column",{attrs:{prop:"skuName",label:"商品名称",width:"80"}}),a("el-table-column",{attrs:{prop:"expectCapacity",label:"当前数量",width:"80"}}),a("el-table-column",{attrs:{prop:"expectCapacity",label:"还可添加",width:"100"}}),a("el-table-column",{attrs:{prop:"address",label:"补满数量"}},[a("div",{staticClass:"input"},[a("el-input-number",{attrs:{"controls-position":"right",min:1,max:10},model:{value:e.num,callback:function(t){e.num=t},expression:"num"}})],1)])],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.onCloseList}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("确 定")])],1)],1)],1),a("el-form-item",{attrs:{label:"运营人员:",prop:"assignorId"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.formData.assignorId,callback:function(t){e.$set(e.formData,"assignorId",t)},expression:"formData.assignorId"}},e._l(e.userNameList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.userName,value:e.userId}})})),1)],1),a("el-form-item",{attrs:{label:"备注:",prop:"desc"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入备注(不超过40字)",maxlength:"40","show-word-limit":""},model:{value:e.formData.desc,callback:function(t){e.$set(e.formData,"desc",t)},expression:"formData.desc"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.onClose}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.onSave}},[e._v("确 定")])],1)],1)},D=[],S={name:"AddWorkList",props:{visible:{type:Boolean,required:!0}},data:function(){return{formData:{assignorId:"",createType:1,desc:"",details:[{channelCode:"1-1",expectCapacity:10,skuId:"2",skuImage:"http://lkd2-java.itheima.net/image/product2.png",skuName:"康师傅冰红茶"}],innerCode:"",productType:"",userId:1},workRoules:{innerCode:[{required:!0,message:"请输入设备编号",trigger:"blur"}],productType:[{required:!0,message:"请选择工单类型",trigger:"blur"}],assignorId:[{required:!0,message:"请选择运营人员",trigger:"blur"}],desc:[{required:!0,message:"请输入备注",trigger:"blur"}]},productTypeList:[],dialogVisible:!1,tableData:[],list:[],num:0,userNameList:[]}},created:function(){this.getAllWorkType(),this.getWorkOrderList()},methods:{onClose:function(){this.$emit("update:visible",!1),this.formData.desc="",this.formData.innerCode="",this.formData.productType="",this.formData.userId="",this.formData.assignorId="",this.userNameList=[]},onCloseList:function(){this.dialogVisible=!1},getAllWorkType:function(){var e=this;return Object(n["a"])(Object(i["a"])().mark((function t(){var a;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,v({alertValue:50});case 2:a=t.sent,e.productTypeList=a.data;case 4:case"end":return t.stop()}}),t)})))()},replenishment:function(){var e=this;return Object(n["a"])(Object(i["a"])().mark((function t(){var a;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.dialogVisible=!0,t.next=3,w(e.list[0].taskId);case 3:a=t.sent,console.log(a.data),e.tableData=a.data;case 6:case"end":return t.stop()}}),t)})))()},getWorkOrderList:function(){var e=this;return Object(n["a"])(Object(i["a"])().mark((function t(){var a;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,g();case 2:a=t.sent,e.list=a.data.currentPageRecords;case 4:case"end":return t.stop()}}),t)})))()},replenishments:function(){var e=this;return Object(n["a"])(Object(i["a"])().mark((function t(){var a;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,x(e.formData.innerCode);case 2:a=t.sent,e.userNameList=a.data;case 4:case"end":return t.stop()}}),t)})))()},onSave:function(){var e=this;return Object(n["a"])(Object(i["a"])().mark((function t(){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.form.validate();case 2:return t.prev=2,t.next=5,k(e.formData);case 5:e.$message.success("新建成功"),e.onClose(),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](2),e.$message.error(t.t0.response.data);case 12:case"end":return t.stop()}}),t,null,[[2,9]])})))()}}},L=S,$=(a("23d1"),Object(d["a"])(L,_,D,!1,null,"04aabbb8",null)),V=$.exports,W={name:"Operating",data:function(){return{searchItem:{firstItem:"工单编号: ",secondItem:"工单状态: ",isSelect:!0,selectOption:[{label:"待办",value:"1"},{label:"进行",value:"2"},{label:"取消",value:"3"},{label:"完成",value:"4"}],formInline:{user:"",region:""}},paging:{},dialogVisible:!1,dialogVisibleTwo:!1,form:{num:1},formRules:{num:[{required:!0}]},dialogVisibleTree:!1,list:{},dialogVisiblefoure:!1,ReplenishmentDetails:[]}},created:function(){},methods:{searchGoods:function(e){var t=e.user,a=e.region;this.$refs.workPaging.getWorkOrderList(t,a)},pagingFn:function(e){this.paging=e},PreviousPage:function(){this.$refs.workPaging.pageIndexjianjian(),this.$refs.workPaging.getWorkOrderList()},nextPage:function(){this.$refs.workPaging.pageIndexjiajia(),this.$refs.workPaging.getWorkOrderList()},newGoods:function(){this.dialogVisible=!0},onSave:function(){var e=this;return Object(n["a"])(Object(i["a"])().mark((function t(){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,I();case 2:e.dialogVisibleTwo=!1;case 3:case"end":return t.stop()}}),t)})))()},handleChange:function(e){this.form.num=e},editWork:function(e){this.list=e,this.dialogVisibleTree=!0},clickFn:function(){var e=this;return Object(n["a"])(Object(i["a"])().mark((function t(){var a;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log(111),e.dialogVisiblefoure=!0,t.next=4,w(e.list.taskId);case 4:a=t.sent,console.log(a.data),e.ReplenishmentDetails=a.data;case 7:case"end":return t.stop()}}),t)})))()},onClose:function(){this.dialogVisiblefoure=!1},delWork:function(){var e=this;return Object(n["a"])(Object(i["a"])().mark((function t(){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$confirm("此操作将取消该订单, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(n["a"])(Object(i["a"])().mark((function t(){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,y(e.list);case 3:e.dialogVisibleTree=!1,e.$message({type:"success",message:"删除成功!"}),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),e.$message.error(t.t0.response.data);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))).catch((function(){e.$message({type:"info",message:"已取消删除"})}));case 1:case"end":return t.stop()}}),t)})))()}},components:{searchTop:m,workTable:j,addWorkList:V}},P=W,N=(a("b8db"),Object(d["a"])(P,r,s,!1,null,"63494a4e",null));t["default"]=N.exports},b8db:function(e,t,a){"use strict";a("35ea")},ccc0:function(e,t,a){},d527:function(e,t,a){"use strict";a("6997")}}]);